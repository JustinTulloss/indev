#!/usr/bin/env node

var fs = require("fs");
var cp = require('child_process');

if (fs.existsSync('node_modules/indev/bin/indev')) {
  cp.spawn('./node_modules/indev/bin/indev', process.argv.slice(1), { stdio: 'inherit' });
  return;
}

var opt = require('optimist');

var argv = opt
      .options('list', { alias: 'l' })
      .options('file', { alias: 'f' })
      .options('version', { alias: 'v' })
      .options('help', { alias: 'h' })
      .argv;

if ( !argv.list && !/indev/.test(process.env.DEBUG) ) {
  process.env.DEBUG = (process.env.DEBUG || '') + ',indev:run,indev:read,indev:exec,indev:exec:async,indev:exec:sync,indev:tasks,devfile:*';
}

var indev = require('../');

if(argv.help) require('show-help');
if(argv.version) require('show-version');
if(argv.list) require('../lib/list');

indev(argv);
